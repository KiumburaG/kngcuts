<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - KNGCuts</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script>if(localStorage.getItem('kngcuts-theme')==='dark')document.documentElement.setAttribute('data-theme','dark');</script>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo" style="text-decoration:none;">
                <span class="logo-text">K</span><span class="barber-pole">I</span><span class="logo-text">NG Cuts</span>
            </a>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="admin-calendar.html">Calendar</a></li>
                <li><a href="#" class="active">Dashboard</a></li>
                <li><button id="logoutBtn" class="admin-btn">Logout</button></li>
            </ul>
            <button id="darkModeToggle" class="dark-mode-toggle" aria-label="Toggle dark mode"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="#D4AF37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></button>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <div class="admin-dash-container">
        <!-- Welcome Header -->
        <div class="admin-dash-header">
            <div class="admin-dash-welcome">
                <div class="clipper-icon">
                    <svg class="clipper-svg" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="8" y="18" width="40" height="22" rx="4" fill="var(--primary-color)" class="clipper-body"/>
                        <rect x="42" y="20" width="16" height="8" rx="2" fill="var(--primary-color)" opacity="0.8" class="clipper-blade-top"/>
                        <rect x="42" y="30" width="16" height="8" rx="2" fill="var(--primary-color)" opacity="0.6" class="clipper-blade-bottom"/>
                        <rect x="10" y="22" width="6" height="14" rx="2" fill="var(--primary-color)" opacity="0.4"/>
                        <line x1="20" y1="24" x2="38" y2="24" stroke="rgba(0,0,0,0.15)" stroke-width="1.5" stroke-linecap="round"/>
                        <line x1="20" y1="28" x2="38" y2="28" stroke="rgba(0,0,0,0.15)" stroke-width="1.5" stroke-linecap="round"/>
                        <line x1="20" y1="32" x2="38" y2="32" stroke="rgba(0,0,0,0.15)" stroke-width="1.5" stroke-linecap="round"/>
                        <rect x="44" y="22" width="12" height="1" fill="rgba(0,0,0,0.2)" rx="0.5" class="blade-teeth"/>
                        <rect x="44" y="24" width="12" height="1" fill="rgba(0,0,0,0.2)" rx="0.5" class="blade-teeth"/>
                        <rect x="44" y="32" width="12" height="1" fill="rgba(0,0,0,0.2)" rx="0.5" class="blade-teeth"/>
                        <rect x="44" y="34" width="12" height="1" fill="rgba(0,0,0,0.2)" rx="0.5" class="blade-teeth"/>
                    </svg>
                </div>
                <div>
                    <h1>Welcome back, <span id="adminName">Admin</span></h1>
                    <p class="admin-dash-subtitle">Manage your barbershop from one place</p>
                </div>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="admin-dash-stats">
            <div class="stat-card">
                <div class="stat-icon"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/><line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/><line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/><rect x="8" y="14" width="3" height="3" rx="0.5" fill="#D4AF37"/></svg></div>
                <div class="stat-info">
                    <span class="stat-number" id="statAppointments">--</span>
                    <span class="stat-label">Upcoming Appointments</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><circle cx="8.5" cy="8.5" r="1.5" fill="#D4AF37"/><path d="M21 15l-5-5L5 21" stroke="#D4AF37" stroke-width="2"/></svg></div>
                <div class="stat-info">
                    <span class="stat-number" id="statPhotos">--</span>
                    <span class="stat-label">Gallery Photos</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07" stroke="#D4AF37" stroke-width="2"/></svg></div>
                <div class="stat-info">
                    <span class="stat-number" id="statBlocked">--</span>
                    <span class="stat-label">Blocked Dates</span>
                </div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="admin-dash-grid">
            <!-- Manage Appointments -->
            <div class="dash-card dash-card-wide">
                <div class="dash-card-header">
                    <h2>Manage Appointments</h2>
                </div>
                <div class="dash-card-body">
                    <div id="appointmentsList" class="appointments-accordion">
                        <p style="text-align:center;color:var(--muted-text);padding:1rem;">Loading appointments...</p>
                    </div>
                </div>
            </div>

            <!-- Gallery Upload -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <h2>Upload Haircut Images</h2>
                </div>
                <div class="dash-card-body">
                    <input type="text" id="imageLabel" class="dash-input" placeholder="Label (e.g. Mid Fade, Buzz Cut)">
                    <input type="file" id="imageUpload" accept="image/*,.heic,.heif" multiple class="dash-file-input">
                    <button id="uploadBtn" class="dash-btn dash-btn-primary">Upload Images</button>
                    <div id="uploadStatus"></div>
                </div>
            </div>

            <!-- Manage Gallery -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <h2>Manage Gallery</h2>
                </div>
                <div class="dash-card-body">
                    <div id="adminGallery" class="admin-gallery"></div>
                    <button id="saveGalleryOrderBtn" class="dash-btn dash-btn-primary save-order-btn" style="display:none;">Save Order</button>
                </div>
            </div>

            <!-- Manage Reviews -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <h2>Manage Reviews</h2>
                </div>
                <div class="dash-card-body">
                    <div id="adminReviews" class="admin-reviews">
                        <p style="text-align:center;color:var(--muted-text);padding:1rem;">Loading reviews...</p>
                    </div>
                </div>
            </div>

            <!-- Homepage Background -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <h2>Homepage Background</h2>
                </div>
                <div class="dash-card-body">
                    <div id="heroPreview" class="hero-preview-box"></div>
                    <input type="file" id="heroUpload" accept="image/*,.heic,.heif" class="dash-file-input">
                    <div class="hero-btn-row">
                        <button id="heroUploadBtn" class="dash-btn dash-btn-primary">Change Background</button>
                        <button id="heroResetBtn" class="dash-btn dash-btn-danger">Reset to Default</button>
                    </div>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <h2>Quick Links</h2>
                </div>
                <div class="dash-card-body dash-links">
                    <a href="admin-calendar.html" class="dash-link-btn">
                        <span class="dash-link-icon"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/><line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/><line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/><rect x="8" y="14" width="3" height="3" rx="0.5" fill="#D4AF37"/></svg></span>
                        <span>Manage Calendar & Availability</span>
                    </a>
                    <a href="index.html" class="dash-link-btn">
                        <span class="dash-link-icon"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z" stroke="currentColor" stroke-width="2"/><polyline points="9 22 9 12 15 12 15 22" stroke="#D4AF37" stroke-width="2"/></svg></span>
                        <span>View Live Website</span>
                    </a>
                    <a href="bookings.html" class="dash-link-btn">
                        <span class="dash-link-icon"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="6" r="3" stroke="currentColor" stroke-width="2"/><circle cx="6" cy="18" r="3" stroke="currentColor" stroke-width="2"/><line x1="20" y1="4" x2="8.12" y2="15.88" stroke="#D4AF37" stroke-width="2"/><line x1="14.47" y1="14.48" x2="20" y2="20" stroke="#D4AF37" stroke-width="2"/><line x1="8.12" y1="8.12" x2="12" y2="12" stroke="currentColor" stroke-width="2"/></svg></span>
                        <span>Booking Page</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Kiumbura N. Githinji. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
    <script src="supabase-config.js"></script>
    <script src="auth-state.js"></script>
    <script src="nav-auth.js"></script>
    <script src="dark-mode.js"></script>
    <script src="live-bg.js"></script>
    <script src="admin-dashboard.js"></script>
</body>
</html>
