<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Calendar - KNGCuts</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script>if(localStorage.getItem('kngcuts-theme')==='dark')document.documentElement.setAttribute('data-theme','dark');</script>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo" style="text-decoration:none;">
                <span class="logo-text">K</span><span class="barber-pole">I</span><span class="logo-text">NG Cuts</span>
            </a>
            <ul class="nav-menu">
                <li><a href="admin-dashboard.html">Back to Dashboard</a></li>
                <li><a href="index.html">Home</a></li>
                <li><a href="#" class="active">Calendar</a></li>
            </ul>
            <button id="darkModeToggle" class="dark-mode-toggle" aria-label="Toggle dark mode"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="#D4AF37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></button>
        </div>
    </nav>

    <div class="admin-calendar-container">
        <div class="admin-header">
            <a href="admin-dashboard.html" class="back-to-dash">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                Back to Dashboard
            </a>
            <h1>Manage Calendar & Availability</h1>
            <p>Set your available hours, manage blocked dates, and preview what clients see</p>
        </div>

        <div class="calendar-workspace">
            <!-- LEFT COLUMN: Schedule + Block Dates -->
            <div class="workspace-left">
                <div class="availability-section">
                    <h2>Weekly Schedule</h2>
                    <div class="weekly-schedule">
                        <div class="day-schedule">
                            <label>
                                <input type="checkbox" class="day-toggle" data-day="monday" checked>
                                <span class="day-name">Monday</span>
                            </label>
                            <div class="time-inputs">
                                <input type="time" class="start-time" data-day="monday" value="09:00">
                                <span>to</span>
                                <input type="time" class="end-time" data-day="monday" value="18:00">
                            </div>
                            <div class="break-time-controls">
                                <label class="break-label">
                                    <input type="checkbox" class="break-toggle" data-day="monday">
                                    <span>Break</span>
                                </label>
                                <div class="break-time-inputs">
                                    <input type="time" class="break-start" data-day="monday" value="12:00" disabled>
                                    <span>-</span>
                                    <input type="time" class="break-end" data-day="monday" value="13:00" disabled>
                                </div>
                            </div>
                        </div>

                        <div class="day-schedule">
                            <label>
                                <input type="checkbox" class="day-toggle" data-day="tuesday" checked>
                                <span class="day-name">Tuesday</span>
                            </label>
                            <div class="time-inputs">
                                <input type="time" class="start-time" data-day="tuesday" value="09:00">
                                <span>to</span>
                                <input type="time" class="end-time" data-day="tuesday" value="18:00">
                            </div>
                            <div class="break-time-controls">
                                <label class="break-label">
                                    <input type="checkbox" class="break-toggle" data-day="tuesday">
                                    <span>Break</span>
                                </label>
                                <div class="break-time-inputs">
                                    <input type="time" class="break-start" data-day="tuesday" value="12:00" disabled>
                                    <span>-</span>
                                    <input type="time" class="break-end" data-day="tuesday" value="13:00" disabled>
                                </div>
                            </div>
                        </div>

                        <div class="day-schedule">
                            <label>
                                <input type="checkbox" class="day-toggle" data-day="wednesday" checked>
                                <span class="day-name">Wednesday</span>
                            </label>
                            <div class="time-inputs">
                                <input type="time" class="start-time" data-day="wednesday" value="09:00">
                                <span>to</span>
                                <input type="time" class="end-time" data-day="wednesday" value="18:00">
                            </div>
                            <div class="break-time-controls">
                                <label class="break-label">
                                    <input type="checkbox" class="break-toggle" data-day="wednesday">
                                    <span>Break</span>
                                </label>
                                <div class="break-time-inputs">
                                    <input type="time" class="break-start" data-day="wednesday" value="12:00" disabled>
                                    <span>-</span>
                                    <input type="time" class="break-end" data-day="wednesday" value="13:00" disabled>
                                </div>
                            </div>
                        </div>

                        <div class="day-schedule">
                            <label>
                                <input type="checkbox" class="day-toggle" data-day="thursday" checked>
                                <span class="day-name">Thursday</span>
                            </label>
                            <div class="time-inputs">
                                <input type="time" class="start-time" data-day="thursday" value="09:00">
                                <span>to</span>
                                <input type="time" class="end-time" data-day="thursday" value="18:00">
                            </div>
                            <div class="break-time-controls">
                                <label class="break-label">
                                    <input type="checkbox" class="break-toggle" data-day="thursday">
                                    <span>Break</span>
                                </label>
                                <div class="break-time-inputs">
                                    <input type="time" class="break-start" data-day="thursday" value="12:00" disabled>
                                    <span>-</span>
                                    <input type="time" class="break-end" data-day="thursday" value="13:00" disabled>
                                </div>
                            </div>
                        </div>

                        <div class="day-schedule">
                            <label>
                                <input type="checkbox" class="day-toggle" data-day="friday" checked>
                                <span class="day-name">Friday</span>
                            </label>
                            <div class="time-inputs">
                                <input type="time" class="start-time" data-day="friday" value="09:00">
                                <span>to</span>
                                <input type="time" class="end-time" data-day="friday" value="18:00">
                            </div>
                            <div class="break-time-controls">
                                <label class="break-label">
                                    <input type="checkbox" class="break-toggle" data-day="friday">
                                    <span>Break</span>
                                </label>
                                <div class="break-time-inputs">
                                    <input type="time" class="break-start" data-day="friday" value="12:00" disabled>
                                    <span>-</span>
                                    <input type="time" class="break-end" data-day="friday" value="13:00" disabled>
                                </div>
                            </div>
                        </div>

                        <div class="day-schedule">
                            <label>
                                <input type="checkbox" class="day-toggle" data-day="saturday" checked>
                                <span class="day-name">Saturday</span>
                            </label>
                            <div class="time-inputs">
                                <input type="time" class="start-time" data-day="saturday" value="10:00">
                                <span>to</span>
                                <input type="time" class="end-time" data-day="saturday" value="16:00">
                            </div>
                            <div class="break-time-controls">
                                <label class="break-label">
                                    <input type="checkbox" class="break-toggle" data-day="saturday">
                                    <span>Break</span>
                                </label>
                                <div class="break-time-inputs">
                                    <input type="time" class="break-start" data-day="saturday" value="12:00" disabled>
                                    <span>-</span>
                                    <input type="time" class="break-end" data-day="saturday" value="13:00" disabled>
                                </div>
                            </div>
                        </div>

                        <div class="day-schedule">
                            <label>
                                <input type="checkbox" class="day-toggle" data-day="sunday">
                                <span class="day-name">Sunday</span>
                            </label>
                            <div class="time-inputs">
                                <input type="time" class="start-time" data-day="sunday" value="10:00" disabled>
                                <span>to</span>
                                <input type="time" class="end-time" data-day="sunday" value="16:00" disabled>
                            </div>
                            <div class="break-time-controls">
                                <label class="break-label">
                                    <input type="checkbox" class="break-toggle" data-day="sunday" disabled>
                                    <span>Break</span>
                                </label>
                                <div class="break-time-inputs">
                                    <input type="time" class="break-start" data-day="sunday" value="12:00" disabled>
                                    <span>-</span>
                                    <input type="time" class="break-end" data-day="sunday" value="13:00" disabled>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button id="saveSchedule" class="save-btn">Save Weekly Schedule</button>
                </div>

                <div class="blocked-dates-section">
                    <h2>Block Specific Dates</h2>
                    <p>Block dates when you're unavailable (vacation, holidays, etc.)</p>
                    <div class="block-date-form">
                        <input type="date" id="blockDate" min="">
                        <input type="text" id="blockReason" placeholder="Reason (optional)">
                        <button id="addBlockBtn">Block Date</button>
                    </div>
                    <div id="blockedDatesList" class="blocked-dates-list">
                        <!-- Blocked dates will appear here -->
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN: Calendar Overview + Client Preview -->
            <div class="workspace-right">
                <div class="admin-visual-calendar">
                    <h2>Calendar Overview</h2>
                    <div class="admin-calendar-nav">
                        <button id="adminPrevMonth" class="cal-nav-btn">&lsaquo;</button>
                        <span id="adminCalendarMonth">February 2026</span>
                        <button id="adminNextMonth" class="cal-nav-btn">&rsaquo;</button>
                    </div>
                    <div id="adminCalendar" class="admin-calendar-grid">
                        <!-- Calendar grid rendered by JS -->
                    </div>
                    <div class="calendar-legend">
                        <span class="legend-item"><span class="legend-dot legend-open"></span> Open</span>
                        <span class="legend-item"><span class="legend-dot legend-closed"></span> Closed</span>
                        <span class="legend-item"><span class="legend-dot legend-blocked"></span> Blocked</span>
                        <span class="legend-item"><span class="legend-dot legend-past"></span> Past</span>
                    </div>
                </div>

                <div class="client-preview-panel">
                    <h2>Client Preview</h2>
                    <p class="preview-subtitle">What customers see when booking</p>
                    <div class="preview-calendar-nav">
                        <button id="previewPrevMonth" class="cal-nav-btn">&lsaquo;</button>
                        <span id="previewCalendarMonth">February 2026</span>
                        <button id="previewNextMonth" class="cal-nav-btn">&rsaquo;</button>
                    </div>
                    <div id="previewCalendar" class="preview-calendar-grid">
                        <!-- Preview calendar rendered by JS -->
                    </div>
                    <div id="previewTimeSlots" class="preview-time-slots">
                        <p class="preview-hint">Click a date above to see available time slots</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="appointments-section">
            <h2>Upcoming Appointments</h2>
            <div id="appointmentsList" class="appointments-list">
                <!-- Appointments will be loaded here -->
                <div class="no-appointments">
                    <p>No upcoming appointments</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Block Reason Popup -->
    <div id="blockReasonPopup" class="block-reason-popup" style="display:none;">
        <div class="block-reason-modal">
            <h3>Block Date</h3>
            <p id="blockReasonDate"></p>
            <input type="text" id="blockReasonInput" placeholder="Reason (optional)">
            <div class="block-reason-actions">
                <button id="blockReasonCancel" class="confirm-btn-cancel">Cancel</button>
                <button id="blockReasonConfirm" class="confirm-btn-danger">Block</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Kiumbura N. Githinji. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="auth-state.js"></script>
    <script src="nav-auth.js"></script>
    <script src="dark-mode.js"></script>
    <script src="live-bg.js"></script>
    <script src="admin-calendar.js"></script>
</body>
</html>
